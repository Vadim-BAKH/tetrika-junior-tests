"""
Модуль тестов для функции appearance из task3.solution.

Содержит набор тестов с различными вариантами интервалов.
Проверяет корректность подсчёта времени присутствия ученика и учителя.
"""

import pytest
from task3.solution import appearance

tests = [
    # Тест из условия: пересечения с несколькими интервалами
    (
        {
            "lesson": [1594663200, 1594666800],
            "pupil": [
                1594663340,
                1594663389,
                1594663390,
                1594663395,
                1594663396,
                1594666472,
            ],
            "tutor": [1594663290, 1594663430, 1594663443, 1594666473],
        },
        3117,
    ),
    # Тест из условия: сложные пересечения и обрезки по уроку
    (
        {
            "lesson": [1594702800, 1594706400],
            "pupil": [
                1594702789,
                1594704500,
                1594702807,
                1594704542,
                1594704512,
                1594704513,
                1594704564,
                1594705150,
                1594704581,
                1594704582,
                1594704734,
                1594705009,
                1594705095,
                1594705096,
                1594705106,
                1594706480,
                1594705158,
                1594705773,
                1594705849,
                1594706480,
                1594706500,
                1594706875,
                1594706502,
                1594706503,
                1594706524,
                1594706524,
                1594706579,
                1594706641,
            ],
            "tutor": [
                1594700035,
                1594700364,
                1594702749,
                1594705148,
                1594705149,
                1594706463,
            ],
        },
        3577,
    ),
    # Тест из условия: один длинный интервал с обрезкой
    (
        {
            "lesson": [1594692000, 1594695600],
            "pupil": [1594692033, 1594696347],
            "tutor": [1594692017, 1594692066, 1594692068, 1594696341],
        },
        3565,
    ),
    # Дополнительный тест: нет пересечений
    (
        {
            "lesson": [1000, 2000],
            "pupil": [1000, 1100],
            "tutor": [1200, 1300]
        }, 0
    ),
    # Дополнительный тест: полное совпадение интервалов
    (
        {
            "lesson": [1000, 2000],
            "pupil": [1000, 1500],
            "tutor": [1000, 1500]
        }, 500
    ),
    # Дополнительный тест: пересечения частичные
    (
        {
            "lesson": [1000, 2000],
            "pupil": [1000, 1200, 1300, 1500],
            "tutor": [1100, 1400],
        },
        200,  # пересечения: 1100-1200 (100) + 1300-1400 (100)
    ),
]


@pytest.mark.parametrize("intervals, expected", tests)
@pytest.mark.lesson
def test_appearance(intervals, expected):
    """
    Проверяет функцию appearance на различных наборах интервалов.

    Проверяется корректность подсчёта времени присутствия
    ученика и учителя в одно время и в пределах урока.
    """
    assert appearance(intervals) == expected
